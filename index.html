<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>צור קשר</title>
  <meta name="description" content="טופס יצירת קשר מעוצב ובהיר בעברית">
  <style>
    :root{
      --bg:#f7f9fc; --card:#ffffff; --text:#222;
      --muted:#6b7280; --accent:#2b8af7; --accent-2:#1f6fd1;
      --border:#e5e7eb; --success:#1b5e20; --error:#b71c1c;
      --success-bg:#e8f5e9; --error-bg:#ffebee;
    }
    html,body{height:100%}
    body{margin:0; font-family:Arial, Helvetica, sans-serif; background:var(--bg); color:var(--text)}
    .wrap{max-width:860px; margin:40px auto; padding:0 20px}
    .card{
      background:var(--card); padding:30px; border-radius:14px;
      border:1px solid var(--border); box-shadow:0 12px 28px rgba(0,0,0,.07);
    }
    h1{margin:0 0 8px; font-size:28px; text-align:right}
    .subtitle{margin:0 0 22px; color:var(--muted); text-align:right}
    form{display:flex; flex-direction:column; gap:14px}
    label{display:flex; flex-direction:column; text-align:right; font-weight:600}
    input[type="text"], input[type="email"], textarea{
      padding:12px; border:1px solid var(--border); border-radius:12px;
      font-size:16px; direction:rtl; text-align:right; background:#fafafa;
      transition:border-color .15s, background .15s, box-shadow .15s;
    }
    input:focus, textarea:focus{outline:none; border-color:var(--accent); background:#fff; box-shadow:0 0 0 3px rgba(43,138,247,.15)}
    textarea{min-height:160px; resize:vertical}
    .row{display:flex; gap:12px}
    .row > div{flex:1}
    .actions{display:flex; gap:10px; justify-content:flex-end; margin-top:6px}
    button{
      background:var(--accent); color:#fff; padding:12px 18px; border:none;
      border-radius:12px; cursor:pointer; font-weight:700; font-size:16px;
      box-shadow:0 3px 10px rgba(43,138,247,.25); transition:background .15s, transform .05s;
    }
    button:hover{background:var(--accent-2)}
    button:active{transform:translateY(1px)}
    button[disabled]{opacity:.6; cursor:not-allowed}
    .alert{padding:12px; border-radius:12px; font-size:14px; margin-top:8px}
    .alert.success{background:var(--success-bg); color:var(--success); border:1px solid #c8e6c9}
    .alert.error{background:var(--error-bg); color:var(--error); border:1px solid #ef9a9a}
    .note{font-size:13px; color:var(--muted); text-align:right; margin-top:12px}
    @media (max-width:560px){ .row{flex-direction:column} }
    /* iframe נסתר לקבלת תגובת הטופס בלי לעזוב את העמוד */
    iframe.hidden-frame{width:0;height:0;border:0;position:absolute;left:-9999px;top:-9999px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" aria-labelledby="title">
      <h1 id="title">צור קשר</h1>
      <p class="subtitle">מלא/י את פרטיך ונחזור אליך בהקדם.</p>

      <!-- iframe נסתר: היעד שאליו יישלח הטופס. כך נשארים בעמוד, בלי לקרוא את התגובה (אין צורך ב‑CORS). -->
      <iframe name="hiddenFrame" class="hidden-frame" id="hiddenFrame"></iframe>

      <!-- פעולה: שליחה אל ה‑GAS שלך כטופס רגיל (x-www-form-urlencoded), ללא AJAX -->
      <form id="contactForm"
            method="POST"
            target="hiddenFrame"
            action="https://script.google.com/macros/s/AKfycbyvetmYPTz8UM76cI-KjnhGRvfFbCG0_8vBNjKp9qGWAZrei9fchoFcB4hzySJO43nEZg/exec"
            novalidate>
        <div class="row">
          <div>
            <label for="name">שם מלא
              <input type="text" name="name" id="name" required placeholder="שמך המלא">
            </label>
          </div>
          <div>
            <label for="email">אימייל
              <input type="email" name="email" id="email" required placeholder="you@example.com">
            </label>
          </div>
        </div>

        <label for="message">הודעה
          <textarea name="message" id="message" required placeholder="כתוב/י כאן את הודעתך..."></textarea>
        </label>

        <div class="actions">
          <button type="submit" id="sendBtn" aria-label="שלח טופס">שלח</button>
        </div>

        <div id="resultArea" aria-live="polite"></div>
      </form>

      <p class="note">הטופס נשלח בצורה מאובטחת אל Google Apps Script. אין קריאת תגובה ב‑JavaScript ולכן אין בעיות CORS.</p>
    </div>
  </div>

  <script>
    (function(){
      const form = document.getElementById('contactForm');
      const resultArea = document.getElementById('resultArea');
      const sendBtn = document.getElementById('sendBtn');
      const hiddenFrame = document.getElementById('hiddenFrame');

      function showMsg(text, type){
        resultArea.innerHTML = '<div class="alert '+(type==='success'?'success':'error')+'">'+text+'</div>';
      }
      function validate(name, email, message){
        if(!name || !message) return "אנא מלא/י שם והודעה.";
        const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
        if(!re.test(email)) return "כתובת אימייל לא תקינה.";
        return "";
      }

      // כאשר ה‑iframe מסיים טעינה, נציג הודעת הצלחה ונאפס את הכפתור
      hiddenFrame.addEventListener('load', function(){
        // לא קוראים את התוכן (CORS), רק מסמנים כהשליחה הושלמה
        showMsg("ההודעה נשלחה בהצלחה. תודה!", 'success');
        sendBtn.disabled = false;
        sendBtn.textContent = "שלח";
        form.reset();
      });

      form.addEventListener('submit', function(ev){
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const message = document.getElementById('message').value.trim();
        const invalid = validate(name, email, message);
        if(invalid){
          ev.preventDefault();
          showMsg(invalid, 'error');
          return;
        }
        sendBtn.disabled = true;
        sendBtn.textContent = "שולח...";
        // לא מבטלים submit — ניתן לדפדפן לשלוח את הטופס אל ה‑iframe
      });
    })();
  </script>
</body>
</html>
